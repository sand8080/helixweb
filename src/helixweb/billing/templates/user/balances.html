{% extends "base_billing.html" %}

{% load i18n %}

{% block title %}
    {% blocktrans %}
        balances of user #{{ user_id }}
    {% endblocktrans %}
{% endblock %}

{% block user_submenu %}
    {% include "user/billing_sumbmenu.html" %}
{% endblock %}

{% block content %}

    {% load urlutils %}
    {% load localeurl_tags %}

    <div class="bordered">

        <table class="filter_object center">
            <tr>
                <td>
                    <h2 class="menu_linked">
                        {% if "/billing/get_balances/"|is_url_allowed:rights %}
                            <a href="{{ '/billing/user_info/'|chlocale:cur_lang }}{{ user_id }}/">
                                {% trans "user id #" %}{{ user_id }}
                            </a>
                        {% else %}
                            {% trans "user id #" %}{{ user_id }}
                        {% endif %}
                        &rarr;
                        {% trans "balances" %}
                    </h2>

                </td>
            </tr>
        </table>

        <br>

        <table class="center wide">

            {% if balances_error %}

                <tr class="objects_data">
                    <td>
                        <span class="errormessage">{% trans balances_error %}</span>
                    </td>
                </tr>

            {% else %}

                {% if balances %}
                    <tr>
                        <td>
                            <table class="center balance">
                                {% for balance in balances %}
                                    <tr>
                                        <th colspan="2">
                                            {{ balance.currency_code }}
                                            {% allowedurl %}
                                                /billing/modify_balances/{{ user_id }}/{{ balance.id }}/
                                                {% blocktrans %}
                                                    <span class="small_text">(modify)</span>
                                                {% endblocktrans %}
                                            {% endallowedurl %}

                                            {% if not balance.is_active %}
                                                <span class="small_text">(balance disabled)</span>
                                            {% endif %}
                                        </th>
                                     </tr>
                                     <tr {% if not balance.is_active %}class="disabled"{% endif %}>
                                         <td>{% trans "real amount" %}</td>
                                         <td>{{ balance.available_real_amount }}</td>
                                     </tr>
                                     <tr {% if not balance.is_active %}class="disabled"{% endif %}>
                                         <td>{% trans "virtual amount" %}</td>
                                         <td>{{ balance.available_virtual_amount }}</td>
                                     </tr>
                                     <tr {% if not balance.is_active %}class="disabled"{% endif %}>
                                         <td>{% trans "locked amount" %}</td>
                                         <td>{{ balance.locked_amount }}</td>
                                     </tr>

                                     {% if balance.overdraft_limit != '0.0' or  balance.overdraft_limit != '0.00' or balance.overdraft_limit != '0.000' %}
                                     <tr {% if not balance.is_active %}class="disabled"{% endif %}>
                                         <td>{% trans "overdraft limit" %}</td>
                                         <td>{{ balance.overdraft_limit }}</td>
                                     </tr>
                                     {% endif %}
                                     {% if balance.locking_order %}
                                     <tr {% if not balance.is_active %}class="disabled"{% endif %}>
                                         <td>{% trans "locking order" %}</td>
                                         <td>{{ balance.locking_order }}</td>
                                     </tr>
                                     {% endif %}
                                     <tr><td></td></tr>
                                 {% endfor %}
                            </table>
                        </td>
                    </tr>

                {% else %}

                    <tr><th>{% trans "no balances found" %}</th></tr>

                {% endif %}

            {% endif %}

        </table>
    </div>

{% endblock %}
